#include<iostream>
#include<String> 
#include<cctype>
using namespace std ; 

class Shopping 
{
    private : string product_name[100] ,name ,  product_category[100] ; float product_price[100] ; int j = 4 ; string itemcollector ; int quantity ; int quantity2[100] ; int reminder ; string rule ;
    string purchased_name, purchased_category ; float purchased_price ;string purchased_name2[100] , purchased_category2[100] ; float purchased_price2[100] ; float total = 0 ;
     int l = 0 ; string payment_method ; int m = 0 ; string order_status = "Order Confirmed" ; float discounted_total ; string discount ; int letmeknow ; int s = 0 ; 
    public  : 
    void Admin(); 
    void Adminview(); 
    void Adminadd();
    void choosing(); 
    void CustomerPanel(); 
    void CustomerInput(); 
    void CustomerPayment(); 
    void initialization(string , string , float , int) ; 
    void calculate(); 
    void CustomView(); 
    void method_check(); 

    Shopping ()
    {   
    product_name[0] = "Laptop" ; 
    product_name[1] = "Mobile" ; 
    product_name[2] = "Rice" ; 
    product_name[3] = "Shirt" ; 
    product_category[0] = "Electronics" ; 
    product_category[1] = "Electronics" ; 
    product_category[2] = "Grocery" ; 
    product_category[3] = "Clothing" ; 
    product_price[0] = 45000 ; 
    product_price[1] = 20000; 
    product_price[2] = 1200; 
    product_price[3] = 1800 ; 
    }
    
}; 

void Shopping :: Admin()
{
        
    cout<<"-------------ADMIN PANEL-------------"<<endl;
    cout<<endl ; 
    cout<<"1. View Products"<<endl;
    cout<<"2. Add Product"<<endl;
    cout<<"3. Exit Admin Panel"<<endl;
    cout<<"-------------------------------------"<<endl;
    cout<<endl;
    choosing(); 

}
  
void Shopping :: choosing() 
{
    int countadmin ; 
    cout<<"Choose a number  :  " ;
    cin>>countadmin;
    cout<<endl; 

    switch (countadmin)
    {
        case 1 : 
        Adminview(); 
        break;

        case 2 : 
        Adminadd(); 
        break;

        case 3 :  
        return ; 

        default : 
        cout<<"You didnt enter a valid number || Error "<<endl;
        cout<<endl; 
        choosing(); 
        break ; 
        
    }
    
}

void Shopping :: Adminview()
{
    cout<<"-------------ITEMS IN SHOP-------------"<<endl;
    for ( int i=0 ; i<j ; i++)
    {
        int product_id = i+1; 
        cout<<product_id<<"."<<" "<<product_name[i] << " | " << "Rs." <<product_price[i] <<  " | " << product_category[i]<<endl;
    }
    cout<<"---------------------------------------"<<endl;
    cout<<endl;
    choosing(); 

}

void Shopping :: Adminadd() 
{
    int k ; 
    cout<<"Last Product ID : "<<j<<endl ; 
    cout<<"Enter New Product ID (more than last product id)  : " ;
    cin>>k ; 
    if(k-j == 1 )
    {
        j=k ; 
    }
    else 
    {
        cout<<endl;
        cout<<"You Didnt Enter The Correct ID | Error " <<endl;
        cout<<endl;  
        Adminadd();
        return ;
    }
    cout<<"Enter Product Name : " ;
    cin.ignore();
    getline(cin , product_name[j-1]) ; 
    cout<<"Enter Product Price : " ;
    cin>>rule; 

    for ( int v  = 0 ; v<rule.length() ; v++)
    {
        if (!isdigit(rule[v]))
        {    
            cout<<endl; 
            cout<<"Price Can Only Be A Number | Try Again"<<endl;  
            cout<<endl;
            j--; 
            Admin(); 
            return ;   
        }
    }
    product_price[j-1] = stoi(rule) ; 
    cin.ignore(); 
    cout<<"Enter Product category (Electronics , Grocery , Clothing) : " ;
    getline(cin , product_category[j-1]) ;
    if (product_category[j-1] == "Electronics" ||product_category[j-1] == "Grocery" || product_category[j-1] == "Clothing"  )
    {

    }
    else 
    {
        cout<<endl;
        cout<<"Wrong Category | Start Again"<<endl;
        cout<<endl;
        j-- ; 
        Admin(); 
        return ;
    }
    cout<<"PRODUCT ADDED SUCCESSFULLY "<<endl ;  
    choosing(); 
}

void Shopping :: CustomerPanel()
{
    
    
    
    cout<<"-------------CUSTOMER PANEL-------------"<<endl;
    cout<<endl ; 
    cout<<"Enter Your Name  :  ";
    cin.ignore();
    getline(cin , name) ; 
    cout<<endl ; 
    cout<<endl ; 
    cout <<"Avaliable Products : "<<endl;
    cout<<endl;  
    CustomView(); 
    CustomerInput(); 
}

void Shopping :: CustomView()
{
    cout<<"-------------ITEMS IN SHOP-------------"<<endl;
    for ( int i=0 ; i<j ; i++)
    {
        int product_id = i+1; 
        cout<<product_id<<"."<<" "<<product_name[i] << " | " << "Rs." <<product_price[i] <<  " | " << product_category[i]<<endl;
    }
    cout<<"---------------------------------------"<<endl;
    cout<<endl;

}

void Shopping :: CustomerInput() 
{
    
    cout<<"Enter Product ID to add ( or 'done' to checkout )  :  " ;
    cin>>itemcollector ;
    
    if (itemcollector == "done")
    {
        if (s==0)
        {
            cout<<endl;
            cout<<"EMPTY CARD CHECKOUT | Try Again"<<endl ;
            cout<<endl; 
            CustomerPanel(); 
            return ; 
        }
        CustomerPayment(); 
    }
    else 
    {
        s++; 
        for(char c : itemcollector)
    {
    if(!isdigit(c))
    {
        cout<<"Invalid Product ID"<<endl;
        CustomerInput();
        return;
    }
    }
        reminder = stoi(itemcollector) ; 
        if(reminder > j )
        {
            cout<<"You Didnt Enter The Correct ID | Error " <<endl;
            CustomerInput(); 
            return ; 
        }
        purchased_name= product_name[reminder-1] ; 
        purchased_category= product_category[reminder-1] ; 
        purchased_price= product_price[reminder-1] ; 
        cout<<"Enter Quantity : " ;
        cin>>quantity; 
        initialization(purchased_name , purchased_category , purchased_price , quantity ) ;
        CustomerInput(); 
    }
    
}

void Shopping :: CustomerPayment()
{
    order_status = "Order Confirmed";
    cout<<endl ;
    cout<<"Enter Payment Method ( UPI / Card / COD )  :  " ;
    cin.ignore(); 
    getline(cin , payment_method) ; 
    method_check(); 

    if (order_status == " Order Not Allowed ")
    {
        cout<<endl;
        cout<<"COD is NOT allowed for Electronics items."<<endl;
        cout<<"Order Status : "<<order_status<<endl;
        cout<<endl;
        cout<<endl;
        CustomerPanel(); 
        return;  
    }

    calculate(); 
    cout<<endl; 
    cout<<endl; 
    cout<<"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"<<endl; 
    cout<<"                PURCHASE SUMMARY                "<<endl;
    cout<<"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"<<endl; 
    cout<<"Customer        :  "<<name <<endl; 
    cout<<endl;  
    cout<<"ITEMS "<<endl ;
    cout<<endl ; 
    for ( int p = 0 ; p<=letmeknow ; p++)
    {
        cout<<purchased_name2[p] << " " << "x "<<quantity2[p] << " --> " << purchased_price2[p]*quantity2[p] <<endl ;
    } 
    cout<<endl ; 
    bool comma = true ;
    cout<<"Categories      :  { ";
    for ( int q = 0 ; q<m ; q++)
    {
        cout<<purchased_category2[q] ; 
        
        if (m-q==1)
        {
            comma = false ; 
        }
        if(comma)
        cout<< " , " ; 
    }
    cout<<" }"<<endl ; 
    cout<<"Payment Method  :  "<<payment_method <<endl ;
    cout<<endl;
    cout<<"Cart Total      :  "<<total <<endl ; 
    cout<<"Discount        :  "<<discount <<endl;
    cout<<"Final Pay       :  "<<discounted_total<<endl ;
    cout<<"Status          :  "<<order_status<<endl ;
    cout<<endl; 
    cout<<"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"<<endl; 
    cout<<endl;
    cout<<endl;
}

void Shopping :: initialization(string a , string b , float c , int d)
{
    purchased_name2[m] = a  ; 
    purchased_category2[m] = b ; 
    purchased_price2[m] = c ;
    quantity2[m] = d ;
    letmeknow=m ;
    m++ ;
}

void Shopping :: calculate()
{
    for (int n=0 ; n<m ; n++)
    {
        total = total + purchased_price2[n]*quantity2[n] ; 
        
    }

    if (total>=30000 && payment_method=="Card")
    {
        discounted_total = (total*75)/100 ; 
        discount = "25%" ; 
    }
    else if (total <30000 && total>=5000 )
    {
        discounted_total = (total*80)/100 ;
        discount = "20%" ;  
    }
    else if (total<5000 && total >=2000)
    {
        discounted_total = (total*90)/100 ; 
        discount = "10%" ; 
    }
    else 
    {
        discounted_total = total ; 
        discount = "0%" ; 
    }

}

void Shopping :: method_check()
{
    for(int k=0 ; k<=letmeknow ; k++)
    if( purchased_category2[k] == "Electronics" && payment_method == "COD")
    {
        order_status = " Order Not Allowed "  ;       
    }
    
}

int main()
{
    Shopping customer;
    int counter ;
    bool shop = true ;
    while(shop)
    {
    cout<<"================================================"<<endl; 
    cout<<"             SMART SHOPING SYSTEM               "<<endl;
    cout<<"================================================"<<endl; 
    cout<<endl ; 
    cout<<"1. Admin Panel"<<endl;
    cout<<"2. Customer Panel"<<endl;
    cout<<"3. Exit"<<endl;
    cout<<endl;
    cout<<"================================================"<<endl;
    cout<<endl ;
    cout<<"Choose a number  :  " ;

    cin>>counter; 
    cout<<endl; 

    switch(counter)
    {
        case 1 :
        customer.Admin();
        break ;

        case 2 : 
        customer.CustomerPanel(); 
        break ; 

        case 3: 
        shop = false ;

        break ; 

        default : 
        cout<<"You didnt enter a valid number || Error "<<endl;
        cout<<endl; 
        break; 

    }
    }

    cout<<"Thank you for using the system "<<endl;
    return 0 ;


}
